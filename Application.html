<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B'local - Business Application</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&amp;display=swap"
        rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#0373F3',
                        'primary-light': '#e6f0ff',
                        'primary-dark': '#0259c1',
                    }
                }
            }
        }
    </script>
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #f8f9ff; /* Light blue-ish background */
        }

        .gradient-bg {
            background: linear-gradient(135deg, #0373F3 0%, #0259c1 100%);
        }

        .form-section {
            transition: all 0.3s ease;
        }

        .progress-bar-step {
            transition: all 0.3s ease;
        }

        .photo-preview {
            position: relative;
            overflow: hidden;
            border-radius: 0.5rem;
            height: 150px;
            background-size: cover;
            background-position: center;
            border: 1px solid #e5e7eb; /* Added a light border */
        }

        .delete-photo {
            position: absolute;
            top: 8px; /* Adjusted for better placement */
            right: 8px; /* Adjusted for better placement */
            background: rgba(0, 0, 0, 0.6); /* Darker for better contrast */
            color: white;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 14px; /* Make X slightly smaller */
            line-height: 24px;
            transition: background-color 0.2s ease;
        }
        .delete-photo:hover {
            background: rgba(0,0,0,0.8);
        }


        /* Mobile-specific styles */
        @media (max-width: 640px) {
            .photo-preview {
                height: 120px;
            }

            .mobile-menu {
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background-color: #0373F3; /* Primary color for mobile menu */
                z-index: 50;
                display: flex;
                flex-direction: column;
                align-items: center; /* Center items */
                justify-content: center;
                transform: translateX(-100%);
                transition: transform 0.3s ease-in-out;
            }

            .mobile-menu.active {
                transform: translateX(0);
            }
            .mobile-menu a { /* Style links in mobile menu */
                color: white;
                padding: 1rem;
                font-size: 1.25rem;
                text-decoration: none;
                display: block;
                width: 100%;
                text-align: center;
            }
            .mobile-menu a:hover {
                background-color: #0259c1; /* Darker primary on hover */
            }
        }
    </style>
    <style>*,::before,::after{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}::after,::before{--tw-content:''}html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;font-family:ui-sans-serif,system-ui,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji"}body{margin:0;line-height:inherit}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;font-weight:inherit;line-height:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,[type=button],[type=reset],[type=submit]{-webkit-appearance:button;background-color:transparent;background-image:none}[hidden]{display:none!important}</style>

</head>

<body>
    <div class="min-h-screen flex flex-col">
        <header class="gradient-bg text-white py-4 md:py-6">
            <div class="container mx-auto px-4">
                <div class="flex justify-between items-center">
                    <a href="kiezo3.html" class="flex items-center"> <div class="mr-2 font-bold text-xl md:text-2xl">B'local</div>
                    </a>
                    <div class="block sm:hidden">
                        <button id="mobile-menu-button" class="text-white focus:outline-none">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                                stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M4 6h16M4 12h16M4 18h16"></path>
                            </svg>
                        </button>
                    </div>
                    <nav class="hidden sm:block">
                        <ul class="flex space-x-6">
                            <li><a href="kiezo3.html" class="hover:text-blue-200">Home</a></li>
                            <li><a href="#how-it-works-section" class="hover:text-blue-200">How It Works</a></li>
                            <li><a href="#footer-contact" class="hover:text-blue-200">Contact</a></li>
                        </ul>
                    </nav>
                </div>
            </div>
        </header>

        <div id="mobile-menu" class="mobile-menu hidden">
            <div class="absolute top-4 right-4">
                <button id="close-mobile-menu" class="text-white focus:outline-none">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24"
                        stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12">
                        </path>
                    </svg>
                </button>
            </div>
            <a href="kiezo3.html" class="mobile-menu-link">Home</a>
            <a href="#how-it-works-section" class="mobile-menu-link close-menu-on-click">How It Works</a>
            <a href="#footer-contact" class="mobile-menu-link close-menu-on-click">Contact</a>
        </div>

        <main class="flex-grow container mx-auto px-4 py-6 md:py-8">
            <div class="max-w-4xl mx-auto bg-white rounded-lg shadow-lg p-4 md:p-6 lg:p-8 mb-8">
                <h2 class="text-2xl md:text-3xl font-bold text-gray-800 text-center mb-2">Apply to be a Hidden Gem</h2>
                <p class="text-gray-600 text-center mb-6 md:mb-8 text-sm md:text-base">Join our exclusive network of
                    exceptional businesses featured on our app</p>

                <div class="mb-8 md:mb-10">
                    <div class="flex justify-between mb-2">
                        <span class="text-xs md:text-sm font-medium text-gray-700" id="progress-text">Step 1 of 4: Business
                            Details</span>
                        <span class="text-xs md:text-sm font-medium text-primary" id="progress-percentage">25%</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-2.5">
                        <div class="bg-primary h-2.5 rounded-full transition-all duration-500 ease-out" id="progress-bar" style="width: 25%"></div>
                    </div>
                    <div class="flex justify-between mt-2 text-xs text-gray-500">
                        <div class="progress-bar-step flex flex-col items-center text-primary">
                            <div class="w-5 h-5 md:w-6 md:h-6 rounded-full bg-primary flex items-center justify-center text-white text-xs md:text-sm">1</div>
                            <span class="mt-1 font-medium">Details</span>
                        </div>
                        <div class="progress-bar-step flex flex-col items-center">
                            <div class="w-5 h-5 md:w-6 md:h-6 rounded-full bg-gray-300 flex items-center justify-center text-gray-600 text-xs md:text-sm">2</div>
                            <span class="mt-1">Photos</span>
                        </div>
                        <div class="progress-bar-step flex flex-col items-center">
                            <div class="w-5 h-5 md:w-6 md:h-6 rounded-full bg-gray-300 flex items-center justify-center text-gray-600 text-xs md:text-sm">3</div>
                            <span class="mt-1">Menu</span>
                        </div>
                        <div class="progress-bar-step flex flex-col items-center">
                            <div class="w-5 h-5 md:w-6 md:h-6 rounded-full bg-gray-300 flex items-center justify-center text-gray-600 text-xs md:text-sm">4</div>
                            <span class="mt-1">Review</span>
                        </div>
                    </div>
                </div>

                <form id="application-form">
                    <div id="step-1" class="form-section">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6">
                            <div class="col-span-2"><h3 class="text-lg md:text-xl font-semibold text-gray-700 mb-1">Business Details</h3></div>
                            <div><label for="business-name" class="block text-sm font-medium text-gray-700 mb-1">Business Name *</label><input type="text" id="business-name" name="business_name" required class="input-field"></div>
                            <div><label for="business-type" class="block text-sm font-medium text-gray-700 mb-1">Business Type *</label><select id="business-type" name="business_type" required class="input-field bg-white"><option value="">Select type</option><option value="restaurant">Restaurant</option><option value="cafe">Café</option><option value="bakery">Bakery</option><option value="bar">Bar</option><option value="food-truck">Food Truck</option><option value="activity">Activity/Service</option><option value="other">Other</option></select></div>
                            <div class="col-span-2"><label for="address" class="block text-sm font-medium text-gray-700 mb-1">Address *</label><input type="text" id="address" name="address" required class="input-field"></div>
                            <div><label for="city" class="block text-sm font-medium text-gray-700 mb-1">City *</label><input type="text" id="city" name="city" required class="input-field"></div>
                            <div><label for="state" class="block text-sm font-medium text-gray-700 mb-1">State/Province *</label><input type="text" id="state" name="state" required class="input-field"></div>
                            <div><label for="zip" class="block text-sm font-medium text-gray-700 mb-1">ZIP/Postal Code *</label><input type="text" id="zip" name="zip" required class="input-field"></div>
                            <div><label for="phone" class="block text-sm font-medium text-gray-700 mb-1">Phone Number *</label><input type="tel" id="phone" name="phone" required class="input-field"></div>
                            <div><label for="email" class="block text-sm font-medium text-gray-700 mb-1">Email Address *</label><input type="email" id="email" name="email" required class="input-field"></div>
                            <div><label for="website" class="block text-sm font-medium text-gray-700 mb-1">Website (if available)</label><input type="url" id="website" name="website" class="input-field" placeholder="https://"></div>
                            <div class="col-span-2"><label for="google-maps" class="block text-sm font-medium text-gray-700 mb-1">Google Maps Link *</label><input type="url" id="google-maps" name="Maps_link" required class="input-field" placeholder="https://maps.google.com/?q=..."></div>
                            <div class="col-span-2"><label for="description" class="block text-sm font-medium text-gray-700 mb-1">Business Description * <span class="text-xs text-gray-500">(Max 500 chars)</span></label><textarea id="description" name="description" rows="4" required maxlength="500" class="input-field" placeholder="Tell us what makes your business special..."></textarea><p id="char-count" class="text-xs text-gray-500 text-right mt-1">0/500</p></div>
                        </div>
                        <div class="mt-6 md:mt-8 flex justify-end"><button type="button" id="next-to-step-2" class="btn-primary w-full sm:w-auto">Next: Photos</button></div>
                    </div>

                    <div id="step-2" class="form-section hidden">
                        <div>
                            <h3 class="text-lg md:text-xl font-semibold text-gray-700 mb-1">Business Photos</h3>
                            <p class="text-gray-600 mb-4 md:mb-6 text-sm md:text-base">Upload high-quality photos (minimum 3, maximum 10). These will be used in our app if approved.</p>
                            <div class="mb-4 md:mb-6">
                                <label class="block text-sm font-medium text-gray-700 mb-2">Upload Photos *</label>
                                <div class="flex items-center justify-center w-full">
                                    <label for="photo-upload" class="flex flex-col items-center justify-center w-full h-28 md:h-32 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 hover:bg-gray-100 transition-colors">
                                        <div class="flex flex-col items-center justify-center pt-4 pb-5"><svg class="w-7 h-7 md:w-8 md:h-8 mb-2 md:mb-3 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path></svg><p class="mb-1 md:mb-2 text-xs md:text-sm text-gray-500"><span class="font-semibold">Click to upload</span> or drag and drop</p><p class="text-xs text-gray-400">PNG, JPG, JPEG (MAX. 5MB each)</p></div>
                                        <input id="photo-upload" type="file" class="hidden" accept="image/png, image/jpeg, image/jpg" multiple>
                                    </label>
                                </div>
                            </div>
                            <div id="photo-previews" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-3 md:gap-4 mb-4 md:mb-6"></div>
                            <div id="photo-error" class="text-red-500 text-xs md:text-sm hidden mb-3 md:mb-4">Please upload 3 to 10 photos.</div>
                        </div>
                        <div class="mt-6 md:mt-8 flex flex-col sm:flex-row justify-between gap-3 sm:gap-0">
                            <button type="button" id="back-to-step-1" class="btn-secondary w-full sm:w-auto order-2 sm:order-1">Previous</button>
                            <button type="button" id="next-to-step-3" class="btn-primary w-full sm:w-auto order-1 sm:order-2">Next: Menu</button>
                        </div>
                    </div>

                    <div id="step-3" class="form-section hidden">
                        <div>
                            <h3 class="text-lg md:text-xl font-semibold text-gray-700 mb-1">Menu Information</h3>
                            <p class="text-gray-600 mb-4 md:mb-6 text-sm md:text-base">Provide details about your menu. This helps us evaluate your business.</p>
                            <div class="mb-4 md:mb-6">
                                <label class="block text-sm font-medium text-gray-700 mb-2">Menu Type * <span class="text-xs text-gray-500">(Select all that apply)</span></label>
                                <div class="grid grid-cols-2 sm:grid-cols-3 gap-2 md:gap-3" id="menu-type-checkboxes">
                                    <label class="inline-flex items-center"><input type="checkbox" name="menu_type" value="breakfast" class="form-checkbox"> <span class="ml-2 text-sm">Breakfast</span></label>
                                    <label class="inline-flex items-center"><input type="checkbox" name="menu_type" value="lunch" class="form-checkbox"> <span class="ml-2 text-sm">Lunch</span></label>
                                    <label class="inline-flex items-center"><input type="checkbox" name="menu_type" value="dinner" class="form-checkbox"> <span class="ml-2 text-sm">Dinner</span></label>
                                    <label class="inline-flex items-center"><input type="checkbox" name="menu_type" value="dessert" class="form-checkbox"> <span class="ml-2 text-sm">Dessert</span></label>
                                    <label class="inline-flex items-center"><input type="checkbox" name="menu_type" value="drinks" class="form-checkbox"> <span class="ml-2 text-sm">Drinks</span></label>
                                    <label class="inline-flex items-center"><input type="checkbox" name="menu_type" value="brunch" class="form-checkbox"> <span class="ml-2 text-sm">Brunch</span></label>
                                    <label class="inline-flex items-center"><input type="checkbox" name="menu_type" value="snacks" class="form-checkbox"> <span class="ml-2 text-sm">Snacks/Appetizers</span></label>
                                </div>
                                 <div id="menu-type-error" class="text-red-500 text-xs hidden mt-1">Please select at least one menu type.</div>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6">
                                <div><label for="cuisine-type" class="block text-sm font-medium text-gray-700 mb-1">Cuisine Type *</label><select id="cuisine-type" name="cuisine_type" required class="input-field bg-white"><option value="">Select cuisine</option><option value="american">American</option><option value="italian">Italian</option><option value="mexican">Mexican</option><option value="asian">Asian (General)</option><option value="chinese">Chinese</option><option value="japanese">Japanese</option><option value="indian">Indian</option><option value="french">French</option><option value="mediterranean">Mediterranean</option><option value="middle_eastern">Middle Eastern</option><option value="german">German</option><option value="spanish">Spanish</option><option value="thai">Thai</option><option value="vietnamese">Vietnamese</option><option value="korean">Korean</option><option value="fusion">Fusion</option><option value="other">Other</option></select></div>
                                <div><label for="price-range" class="block text-sm font-medium text-gray-700 mb-1">Price Range *</label><select id="price-range" name="price_range" required class="input-field bg-white"><option value="">Select price range</option><option value="$">$ (Inexpensive)</option><option value="$$">$$ (Moderate)</option><option value="$$$">$$$ (Pricey)</option><option value="$$$$">$$$$ (Very Expensive)</option></select></div>
                            </div>
                            <div class="mt-4 md:mt-6"><label for="signature-dishes" class="block text-sm font-medium text-gray-700 mb-1">Signature Dishes (List up to 5) *</label><textarea id="signature-dishes" name="signature_dishes" rows="4" required class="input-field" placeholder="Enter each dish on a new line"></textarea></div>
                            <div class="mt-4 md:mt-6">
                                <label class="block text-sm font-medium text-gray-700 mb-2">Dietary Options Available <span class="text-xs text-gray-500">(Select all that apply)</span></label>
                                <div class="grid grid-cols-2 sm:grid-cols-3 gap-2 md:gap-3">
                                    <label class="inline-flex items-center"><input type="checkbox" name="dietary_options" value="vegetarian" class="form-checkbox"> <span class="ml-2 text-sm">Vegetarian</span></label>
                                    <label class="inline-flex items-center"><input type="checkbox" name="dietary_options" value="vegan" class="form-checkbox"> <span class="ml-2 text-sm">Vegan</span></label>
                                    <label class="inline-flex items-center"><input type="checkbox" name="dietary_options" value="gluten_free" class="form-checkbox"> <span class="ml-2 text-sm">Gluten-Free</span></label>
                                    <label class="inline-flex items-center"><input type="checkbox" name="dietary_options" value="dairy_free" class="form-checkbox"> <span class="ml-2 text-sm">Dairy-Free</span></label>
                                    <label class="inline-flex items-center"><input type="checkbox" name="dietary_options" value="nut_free" class="form-checkbox"> <span class="ml-2 text-sm">Nut-Free</span></label>
                                    <label class="inline-flex items-center"><input type="checkbox" name="dietary_options" value="halal" class="form-checkbox"> <span class="ml-2 text-sm">Halal</span></label>
                                    <label class="inline-flex items-center"><input type="checkbox" name="dietary_options" value="kosher" class="form-checkbox"> <span class="ml-2 text-sm">Kosher</span></label>
                                </div>
                            </div>
                            <div class="mt-4 md:mt-6"><label for="menu-pdf" class="block text-sm font-medium text-gray-700 mb-2">Upload Menu PDF (optional)</label><input type="file" id="menu-pdf" name="menu_pdf" accept=".pdf" class="file-input"></div>
                        </div>
                        <div class="mt-6 md:mt-8 flex flex-col sm:flex-row justify-between gap-3 sm:gap-0">
                            <button type="button" id="back-to-step-2" class="btn-secondary w-full sm:w-auto order-2 sm:order-1">Previous</button>
                            <button type="button" id="next-to-step-4" class="btn-primary w-full sm:w-auto order-1 sm:order-2">Next: Review</button>
                        </div>
                    </div>

                    <div id="step-4" class="form-section hidden">
                        <div>
                            <h3 class="text-lg md:text-xl font-semibold text-gray-700 mb-1">Review Your Application</h3>
                            <p class="text-gray-600 mb-4 md:mb-6 text-sm md:text-base">Please review your information. You can go back to make changes.</p>
                            <div class="bg-gray-50 p-4 md:p-6 rounded-lg space-y-6">
                                <div><h4 class="font-medium text-gray-700 text-base md:text-lg mb-2">Business Details</h4><div id="review-business-details" class="space-y-2 text-sm"></div></div>
                                <div><h4 class="font-medium text-gray-700 text-base md:text-lg mb-2">Photos (<span id="review-photo-count">0</span>)</h4><div id="review-photos" class="grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 gap-2"></div></div>
                                <div><h4 class="font-medium text-gray-700 text-base md:text-lg mb-2">Menu Information</h4><div id="review-menu-info" class="space-y-2 text-sm"></div></div>
                            </div>
                            <div class="mt-4 md:mt-6"><label class="flex items-start md:items-center"><input type="checkbox" id="terms-agreement" name="terms_agreement" required class="form-checkbox h-4 w-4 md:h-5 md:w-5 text-primary mt-0.5 md:mt-0 focus:ring-primary"><span class="ml-2 text-xs md:text-sm text-gray-700">I agree to the <a href="#" class="text-primary hover:underline">Terms and Conditions</a> and understand my business will be evaluated.</span></label></div>
                             <div id="terms-error" class="text-red-500 text-xs hidden mt-1">You must agree to the terms.</div>
                        </div>
                        <div class="mt-6 md:mt-8 flex flex-col sm:flex-row justify-between gap-3 sm:gap-0">
                            <button type="button" id="back-to-step-3" class="btn-secondary w-full sm:w-auto order-2 sm:order-1">Previous</button>
                            <button type="submit" id="submit-application" class="btn-primary w-full sm:w-auto order-1 sm:order-2">
                                <span class="submit-text">Submit Application</span>
                                <svg class="animate-spin h-5 w-5 text-white hidden submit-spinner" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>
                            </button>
                        </div>
                    </div>
                </form>
            </div>

            <div class="max-w-4xl mx-auto" id="how-it-works-section">
                <h2 class="text-xl md:text-2xl font-bold text-gray-800 text-center mb-6 md:mb-8">How It Works</h2>
                <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4 md:gap-8">
                    <div class="bg-white p-4 md:p-6 rounded-lg shadow-md text-center"><div class="w-12 h-12 md:w-16 md:h-16 bg-primary-light rounded-full flex items-center justify-center mx-auto mb-3 md:mb-4"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 md:h-8 md:w-8 text-primary" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg></div><h3 class="text-base md:text-lg font-semibold text-gray-700 mb-1 md:mb-2">1. Apply</h3><p class="text-gray-600 text-sm">Complete the application with your business details, photos, and menu information.</p></div>
                    <div class="bg-white p-4 md:p-6 rounded-lg shadow-md text-center"><div class="w-12 h-12 md:w-16 md:h-16 bg-primary-light rounded-full flex items-center justify-center mx-auto mb-3 md:mb-4"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 md:h-8 md:w-8 text-primary" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></div><h3 class="text-base md:text-lg font-semibold text-gray-700 mb-1 md:mb-2">2. Evaluation</h3><p class="text-gray-600 text-sm">Our team will review your Google reviews, photos, and send mystery shoppers to evaluate.</p></div>
                    <div class="bg-white p-4 md:p-6 rounded-lg shadow-md text-center"><div class="w-12 h-12 md:w-16 md:h-16 bg-primary-light rounded-full flex items-center justify-center mx-auto mb-3 md:mb-4"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 md:h-8 md:w-8 text-primary" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg></div><h3 class="text-base md:text-lg font-semibold text-gray-700 mb-1 md:mb-2">3. Approval</h3><p class="text-gray-600 text-sm">If approved, you'll get access to payment plans and be featured as a Hidden Gem.</p></div>
                </div>
            </div>
        </main>

        <footer class="bg-gray-800 text-white py-8 md:py-10 mt-8" id="footer-contact">
            <div class="container mx-auto px-4">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                    <div><h3 class="text-lg font-semibold mb-4">B'local</h3><p class="text-gray-400 text-sm">Discover and support exceptional local businesses.</p></div>
                    <div><h3 class="text-lg font-semibold mb-4">Quick Links</h3><ul class="space-y-2"><li ><a href="kiezo3.html" class="text-gray-400 hover:text-white text-sm">Home</a></li><li><a href="#how-it-works-section" class="text-gray-400 hover:text-white text-sm">How It Works</a></li><li><a href="#" class="text-gray-400 hover:text-white text-sm">FAQ</a></li></ul></div>
                    <div><h3 class="text-lg font-semibold mb-4">Contact Us</h3><ul class="space-y-2 text-gray-400"><li class="flex items-center"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-primary" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path></svg><span class="text-sm">info@blocal.app</span></li><li class="flex items-center"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-primary" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path></svg><span class="text-sm">(555) 123-4567</span></li></ul></div>
                </div>
                <div class="border-t border-gray-700 mt-8 pt-6 text-center text-gray-400"><p class="text-xs md:text-sm">© 2024 B'local. All rights reserved.</p></div>
            </div>
        </footer>
    </div>

    <div id="success-modal" class="fixed inset-0 flex items-center justify-center z-50 hidden bg-black bg-opacity-50 transition-opacity duration-300">
        <div class="bg-white rounded-lg p-6 md:p-8 max-w-md w-11/12 mx-auto relative z-10 shadow-xl transform transition-all duration-300 scale-95 opacity-0" id="success-modal-content">
            <div class="text-center">
                <div class="w-12 h-12 md:w-16 md:h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-3 md:mb-4"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 md:h-8 md:w-8 text-green-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg></div>
                <h3 class="text-lg md:text-xl font-bold text-gray-800 mb-2">Application Submitted!</h3>
                <p class="text-gray-600 mb-4 md:mb-6 text-sm md:text-base">Thank you for applying. We'll review your application and be in touch soon.</p>
                <button id="close-modal" class="w-full btn-primary">Close</button>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // --- Style Definitions ---
            const inputFieldClasses = "mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary sm:text-sm".split(" ");
            const btnPrimaryClasses = "inline-flex items-center justify-center px-4 sm:px-6 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-primary hover:bg-primary-dark focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary".split(" ");
            const btnSecondaryClasses = "inline-flex items-center justify-center px-4 sm:px-6 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary".split(" ");
            const formCheckboxClasses = "h-4 w-4 text-primary border-gray-300 rounded focus:ring-primary".split(" ");
            const fileInputClasses = "block w-full text-xs md:text-sm text-gray-500 file:mr-3 file:py-1.5 file:px-3 md:file:py-2 md:file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-primary-light file:text-primary hover:file:bg-blue-100 cursor-pointer border border-gray-300 rounded-md".split(" ");


            function applyStyles() {
                document.querySelectorAll('.input-field').forEach(el => el.classList.add(...inputFieldClasses));
                document.querySelectorAll('.btn-primary').forEach(el => el.classList.add(...btnPrimaryClasses));
                document.querySelectorAll('.btn-secondary').forEach(el => el.classList.add(...btnSecondaryClasses));
                document.querySelectorAll('.form-checkbox').forEach(el => el.classList.add(...formCheckboxClasses));
                document.querySelectorAll('.file-input').forEach(el => el.classList.add(...fileInputClasses));
            }
            applyStyles();

            // --- Mobile menu functionality ---
            const mobileMenuButton = document.getElementById('mobile-menu-button');
            const closeMobileMenuButton = document.getElementById('close-mobile-menu');
            const mobileMenu = document.getElementById('mobile-menu');
            const mobileMenuLinks = document.querySelectorAll('.close-menu-on-click');


            if (mobileMenuButton && mobileMenu && closeMobileMenuButton) {
                mobileMenuButton.addEventListener('click', function () {
                    mobileMenu.classList.remove('hidden');
                    setTimeout(() => mobileMenu.classList.add('active'), 10);
                });
                closeMobileMenuButton.addEventListener('click', function () {
                    mobileMenu.classList.remove('active');
                    setTimeout(() => mobileMenu.classList.add('hidden'), 300);
                });
                mobileMenuLinks.forEach(link => {
                    link.addEventListener('click', () => {
                         mobileMenu.classList.remove('active');
                         setTimeout(() => mobileMenu.classList.add('hidden'), 300);
                    });
                });
            }
            
            // --- Smooth scroll for internal links ---
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    const href = this.getAttribute('href');
                    if (href.length > 1) { // Ensure it's not just "#"
                        e.preventDefault();
                        const targetElement = document.querySelector(href);
                        if (targetElement) {
                            targetElement.scrollIntoView({ behavior: 'smooth' });
                        }
                    }
                });
            });


            // --- Form navigation ---
            const form = document.getElementById('application-form');
            const formSections = ['step-1', 'step-2', 'step-3', 'step-4'];
            const progressBar = document.getElementById('progress-bar');
            const progressText = document.getElementById('progress-text');
            const progressPercentage = document.getElementById('progress-percentage');
            const progressSteps = document.querySelectorAll('.progress-bar-step');
            let currentStep = 0;

            const stepTexts = [
                'Step 1 of 4: Business Details', 'Step 2 of 4: Photos',
                'Step 3 of 4: Menu', 'Step 4 of 4: Review'
            ];

            function showStep(stepIndex) {
                formSections.forEach((sectionId, index) => {
                    const element = document.getElementById(sectionId);
                    element.classList.toggle('hidden', index !== stepIndex);
                });
                currentStep = stepIndex;

                const progress = ((stepIndex + 1) / formSections.length) * 100;
                progressBar.style.width = `${progress}%`;
                progressPercentage.textContent = `${Math.round(progress)}%`;
                progressText.textContent = stepTexts[stepIndex];

                progressSteps.forEach((stepEl, index) => {
                    const circle = stepEl.querySelector('div');
                    const text = stepEl.querySelector('span');
                    if (index <= stepIndex) {
                        circle.classList.remove('bg-gray-300', 'text-gray-600');
                        circle.classList.add('bg-primary', 'text-white');
                        text.classList.add('text-primary', 'font-medium');
                    } else {
                        circle.classList.remove('bg-primary', 'text-white');
                        circle.classList.add('bg-gray-300', 'text-gray-600');
                        text.classList.remove('text-primary', 'font-medium');
                    }
                });
                 window.scrollTo({ top: form.offsetTop - 20, behavior: 'smooth' });
            }

            // --- Validation Functions ---
            function validateStep1() {
                const requiredFields = ['business-name', 'business-type', 'address', 'city', 'state', 'zip', 'phone', 'email', 'google-maps', 'description'];
                let isValid = true;
                requiredFields.forEach(id => {
                    const input = document.getElementById(id);
                    input.classList.remove('border-red-500'); // Clear previous errors
                    if (!input.value.trim()) {
                        input.classList.add('border-red-500');
                        isValid = false;
                    }
                });
                if (!isValid) alert('Please fill in all required fields in Business Details.');
                return isValid;
            }

            const uploadedPhotos = []; // Array to store {id, src, file} objects
            function validateStep2() {
                const photoError = document.getElementById('photo-error');
                photoError.classList.add('hidden');
                if (uploadedPhotos.length < 3 || uploadedPhotos.length > 10) {
                    photoError.textContent = 'Please upload between 3 and 10 photos.';
                    photoError.classList.remove('hidden');
                    return false;
                }
                return true;
            }

            function validateStep3() {
                let isValid = true;
                const requiredSelects = ['cuisine-type', 'price-range'];
                const requiredTextareas = ['signature-dishes'];
                
                requiredSelects.forEach(id => {
                    const select = document.getElementById(id);
                    select.classList.remove('border-red-500');
                    if (!select.value) {
                        select.classList.add('border-red-500');
                        isValid = false;
                    }
                });
                requiredTextareas.forEach(id => {
                     const textarea = document.getElementById(id);
                    textarea.classList.remove('border-red-500');
                    if (!textarea.value.trim()) {
                        textarea.classList.add('border-red-500');
                        isValid = false;
                    }
                });

                const menuTypesChecked = document.querySelectorAll('input[name="menu_type"]:checked').length;
                const menuTypeError = document.getElementById('menu-type-error');
                if (menuTypesChecked === 0) {
                    menuTypeError.classList.remove('hidden');
                    isValid = false;
                } else {
                    menuTypeError.classList.add('hidden');
                }

                if (!isValid) alert('Please fill in all required fields in Menu Information.');
                return isValid;
            }


            // --- Navigation Button Event Listeners ---
            document.getElementById('next-to-step-2').addEventListener('click', () => { if (validateStep1()) showStep(1); });
            document.getElementById('back-to-step-1').addEventListener('click', () => showStep(0));
            document.getElementById('next-to-step-3').addEventListener('click', () => { if (validateStep2()) showStep(2); });
            document.getElementById('back-to-step-2').addEventListener('click', () => showStep(1));
            document.getElementById('next-to-step-4').addEventListener('click', () => { if (validateStep3()) { populateReviewPage(); showStep(3); }});
            document.getElementById('back-to-step-3').addEventListener('click', () => showStep(2));

            // --- Description Character Counter ---
            const descriptionTextarea = document.getElementById('description');
            const charCountDisplay = document.getElementById('char-count');
            if(descriptionTextarea && charCountDisplay) {
                descriptionTextarea.addEventListener('input', function() {
                    charCountDisplay.textContent = `${this.value.length}/500`;
                });
            }

            // --- Photo Upload Handling ---
            const photoUploadInput = document.getElementById('photo-upload');
            const photoPreviewsContainer = document.getElementById('photo-previews');

            if(photoUploadInput && photoPreviewsContainer) {
                photoUploadInput.addEventListener('change', function (e) {
                    const files = e.target.files;
                    const photoError = document.getElementById('photo-error');
                    photoError.classList.add('hidden');

                    for (let i = 0; i < files.length; i++) {
                        if (uploadedPhotos.length >= 10) {
                            photoError.textContent = 'Maximum 10 photos allowed.';
                            photoError.classList.remove('hidden');
                            break;
                        }
                        const file = files[i];
                        if (!file.type.startsWith('image/')) {
                            photoError.textContent = `File "${file.name}" is not a valid image.`;
                            photoError.classList.remove('hidden');
                            continue;
                        }
                        if (file.size > 5 * 1024 * 1024) { // 5MB limit
                             photoError.textContent = `File "${file.name}" exceeds 5MB limit.`;
                            photoError.classList.remove('hidden');
                            continue;
                        }

                        const reader = new FileReader();
                        const photoId = 'photo-' + Date.now() + '-' + Math.random().toString(36).substr(2, 5);
                        
                        reader.onload = function (e) {
                            const photoDiv = document.createElement('div');
                            photoDiv.className = 'photo-preview';
                            photoDiv.id = photoId;
                            photoDiv.style.backgroundImage = `url(${e.target.result})`;

                            const deleteBtn = document.createElement('div');
                            deleteBtn.className = 'delete-photo';
                            deleteBtn.innerHTML = '&times;';
                            deleteBtn.addEventListener('click', function () {
                                const indexToRemove = uploadedPhotos.findIndex(p => p.id === photoId);
                                if (indexToRemove !== -1) uploadedPhotos.splice(indexToRemove, 1);
                                photoPreviewsContainer.removeChild(photoDiv);
                                validateStep2(); // Re-validate after removal
                            });
                            photoDiv.appendChild(deleteBtn);
                            photoPreviewsContainer.appendChild(photoDiv);
                            uploadedPhotos.push({ id: photoId, src: e.target.result, file: file });
                        }
                        reader.readAsDataURL(file);
                    }
                    this.value = ''; // Clear the input for next selection
                });
            }

            // --- Populate Review Page ---
            function populateReviewPage() {
                // Business Details
                const businessDetailsContainer = document.getElementById('review-business-details');
                businessDetailsContainer.innerHTML = `
                    <p><strong class="text-gray-600">Name:</strong> ${document.getElementById('business-name').value}</p>
                    <p><strong class="text-gray-600">Type:</strong> ${document.getElementById('business-type').value}</p>
                    <p><strong class="text-gray-600">Address:</strong> ${document.getElementById('address').value}, ${document.getElementById('city').value}, ${document.getElementById('state').value} ${document.getElementById('zip').value}</p>
                    <p><strong class="text-gray-600">Phone:</strong> ${document.getElementById('phone').value}</p>
                    <p><strong class="text-gray-600">Email:</strong> ${document.getElementById('email').value}</p>
                    <p><strong class="text-gray-600">Website:</strong> ${document.getElementById('website').value || 'N/A'}</p>
                    <p><strong class="text-gray-600">Google Maps:</strong> <a href="${document.getElementById('google-maps').value}" target="_blank" class="text-primary hover:underline">${document.getElementById('google-maps').value}</a></p>
                    <p><strong class="text-gray-600">Description:</strong> ${document.getElementById('description').value}</p>
                `;

                // Photos
                const reviewPhotosContainer = document.getElementById('review-photos');
                reviewPhotosContainer.innerHTML = '';
                document.getElementById('review-photo-count').textContent = uploadedPhotos.length;
                uploadedPhotos.forEach(photo => {
                    const img = document.createElement('img');
                    img.src = photo.src;
                    img.alt = 'Uploaded Photo Preview';
                    img.className = 'w-full h-16 md:h-20 object-cover rounded';
                    reviewPhotosContainer.appendChild(img);
                });

                // Menu Info
                const menuInfoContainer = document.getElementById('review-menu-info');
                const menuTypes = Array.from(document.querySelectorAll('input[name="menu_type"]:checked')).map(cb => cb.value).join(', ') || 'N/A';
                const dietaryOptions = Array.from(document.querySelectorAll('input[name="dietary_options"]:checked')).map(cb => cb.value).join(', ') || 'N/A';
                const menuPdfFile = document.getElementById('menu-pdf').files[0];

                menuInfoContainer.innerHTML = `
                    <p><strong class="text-gray-600">Menu Types:</strong> ${menuTypes}</p>
                    <p><strong class="text-gray-600">Cuisine Type:</strong> ${document.getElementById('cuisine-type').value}</p>
                    <p><strong class="text-gray-600">Price Range:</strong> ${document.getElementById('price-range').value}</p>
                    <p><strong class="text-gray-600">Signature Dishes:</strong></p>
                    <pre class="bg-gray-100 p-2 rounded text-xs whitespace-pre-wrap">${document.getElementById('signature-dishes').value}</pre>
                    <p><strong class="text-gray-600">Dietary Options:</strong> ${dietaryOptions}</p>
                    <p><strong class="text-gray-600">Menu PDF:</strong> ${menuPdfFile ? menuPdfFile.name : 'Not uploaded'}</p>
                `;
            }

            // --- Form Submission ---
            const successModal = document.getElementById('success-modal');
            const successModalContent = document.getElementById('success-modal-content');
            const closeModalButton = document.getElementById('close-modal');
            const submitButton = document.getElementById('submit-application');
            const submitText = submitButton.querySelector('.submit-text');
            const submitSpinner = submitButton.querySelector('.submit-spinner');
            const termsError = document.getElementById('terms-error');


            form.addEventListener('submit', async function (e) {
                e.preventDefault();
                const termsCheckbox = document.getElementById('terms-agreement');
                termsError.classList.add('hidden');

                if (!termsCheckbox.checked) {
                    termsError.classList.remove('hidden');
                    termsCheckbox.focus();
                    return;
                }

                submitText.classList.add('hidden');
                submitSpinner.classList.remove('hidden');
                submitButton.disabled = true;

                const formData = new FormData();
                // Step 1 data
                ['business_name', 'business_type', 'address', 'city', 'state', 'zip', 'phone', 'email', 'website', 'Maps_link', 'description']
                    .forEach(id => formData.append(id, document.getElementById(id.replace(/_/g, '-')).value));
                
                // Step 2 data (photos)
                uploadedPhotos.forEach((photo, index) => {
                    formData.append(`photos[${index}]`, photo.file, photo.file.name); // Send the actual File object
                });

                // Step 3 data
                document.querySelectorAll('input[name="menu_type"]:checked').forEach(cb => formData.append('menu_types[]', cb.value));
                formData.append('cuisine_type', document.getElementById('cuisine-type').value);
                formData.append('price_range', document.getElementById('price-range').value);
                formData.append('signature_dishes', document.getElementById('signature-dishes').value);
                document.querySelectorAll('input[name="dietary_options"]:checked').forEach(cb => formData.append('dietary_options[]', cb.value));
                const menuPdfFile = document.getElementById('menu-pdf').files[0];
                if (menuPdfFile) formData.append('menu_pdf', menuPdfFile, menuPdfFile.name);

                // HYPOTHETICAL BACKEND SUBMISSION
                try {
                    console.log("Submitting FormData to backend (conceptual)...");
                    // for (let [key, value] of formData.entries()) { console.log(key, value); } // For debugging FormData

                    // const response = await fetch('/api/applications', {
                    //     method: 'POST',
                    //     body: formData // FormData sets Content-Type to multipart/form-data automatically
                    // });

                    // MOCKING API RESPONSE after a delay
                    await new Promise(resolve => setTimeout(resolve, 1500)); // Simulate network delay
                    const mockResponse = { ok: true }; // Simulate a successful response
                    // const mockResponse = { ok: false, status: 400, json: async () => ({ message: "Mock server error: Invalid data."}) }; // Simulate error


                    if (mockResponse.ok) {
                        successModal.classList.remove('hidden');
                        setTimeout(() => { // For modal animation
                            successModal.classList.remove('bg-opacity-0');
                            successModal.classList.add('bg-opacity-50');
                            successModalContent.classList.remove('scale-95', 'opacity-0');
                            successModalContent.classList.add('scale-100', 'opacity-100');
                        }, 10);
                    } else {
                        // const errorData = await mockResponse.json();
                        // alert(`Submission failed: ${errorData.message || 'Unknown error'}`);
                        alert(`Mock Submission Failed: There was an issue with your application.`);
                    }
                } catch (error) {
                    console.error('Submission error:', error);
                    alert('An error occurred while submitting your application. Please try again.');
                } finally {
                    submitText.classList.remove('hidden');
                    submitSpinner.classList.add('hidden');
                    submitButton.disabled = false;
                }
            });

            if(closeModalButton && successModal) {
                closeModalButton.addEventListener('click', function () {
                    successModalContent.classList.remove('scale-100', 'opacity-100');
                    successModalContent.classList.add('scale-95', 'opacity-0');
                    successModal.classList.remove('bg-opacity-50');
                    successModal.classList.add('bg-opacity-0');
                    setTimeout(() => {
                        successModal.classList.add('hidden');
                        form.reset();
                        uploadedPhotos.length = 0; // Clear the array
                        if(photoPreviewsContainer) photoPreviewsContainer.innerHTML = ''; // Clear previews
                        showStep(0); // Go back to step 1
                    }, 300);
                });
            }
        });
    </script>
    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.8.1/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/11.8.1/firebase-analytics.js";
        // TODO: Add SDKs for Firebase products that you want to use
        // https://firebase.google.com/docs/web/setup#available-libraries

        // Your web app's Firebase configuration
        // For Firebase JS SDK v7.20.0 and later, measurementId is optional
        const firebaseConfig = {
            apiKey: "AIzaSyDKcREr-zJD-nofGVMImYvOe3fwiRaa9GQ",
            authDomain: "test-86a96.firebaseapp.com",
            projectId: "test-86a96",
            storageBucket: "test-86a96.firebasestorage.app",
            messagingSenderId: "447058829158",
            appId: "1:447058829158:web:ca487713545330d728f2a7",
            measurementId: "G-J7ET8S88PR"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
    </script>
</body>
</html>